<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Stream a log file | Elastic Observability [master] | Elastic</title>
<meta class="elastic" name="content" content="Stream a log file | Elastic Observability [master]">

<link rel="home" href="index.html" title="Elastic Observability [master]"/>
<link rel="up" href="logs-observability-overview.html" title="Logs overview"/>
<link rel="prev" href="logs-checklist.html" title="Logs resource guide"/>
<link rel="next" href="monitor-logs.html" title="Log monitoring"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/master"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="logs-observability-overview.html">Logs overview</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="logs-checklist.html">« Logs resource guide</a>
</span>
<span class="next">
<a href="monitor-logs.html">Log monitoring »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="logs-stream"></a>Stream a log file<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/logs-stream.asciidoc">edit</a></h2>
</div></div></div>
<p>In this guide, you&#8217;ll learn how to take a log file from your host and send it to Elasticsearch using a standalone Elastic Agent. You&#8217;ll configure the Elastic Agent and your data streams using the Custom Logs integration. From there, you&#8217;ll learn how to query your logs and use the data streams you&#8217;ve set up to have more control and flexibility when filtering your log data.</p>
<h3><a id="logs-stream-prereq"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/logs-stream.asciidoc">edit</a></h3>
<p>To follow the steps in this guide, you need an Elastic Stack deployment that includes:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elasticsearch for storing and searching data
</li>
<li class="listitem">
Kibana for visualizing and managing data
</li>
<li class="listitem">
Kibana user with <code class="literal">All</code> privileges on Fleet and Integrations. Since many
Integrations assets are shared across spaces, users need the Kibana privileges
in all spaces.
</li>
<li class="listitem">
Integrations Server (included by default in every Elasticsearch Service deployment)
</li>
</ul>
</div>
<p>To get started quickly, spin up a deployment of our hosted Elasticsearch Service. The Elasticsearch Service is
available on AWS, GCP, and Azure. <a href="/cloud/elasticsearch-service/signup?baymax=docs-body&amp;elektra=docs" class="ulink" target="_top">Try it out for free</a>.</p>
<h3><a id="logs-stream-install-config-agent"></a>Install and configure the standalone Elastic Agent<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/logs-stream.asciidoc">edit</a></h3>
<p>Install and configure the standalone Elastic Agent to send your log data to Elasticsearch by completing the following steps:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Download and extract the Elastic Agent installation package.
</li>
<li class="listitem">
Configure the Elastic Agent using the Custom Logs integration.
</li>
<li class="listitem">
Install and start the Elastic Agent.
</li>
</ol>
</div>
<h4><a id="logs-stream-extract-agent"></a>Step 1: Download and extract the Elastic Agent installation package<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/logs-stream.asciidoc">edit</a></h4>
<p>On your host, download and extract the installation package that corresponds with your system:</p>
<div class="tabs" data-tab-group="os">
  <div role="tablist" aria-label="Download">
    <button role="tab"
            aria-selected="true"
            aria-controls="mac-tab-download"
            id="mac-download">
      macOS
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="linux-tab-download"
            id="linux-download"
            tabindex="-1">
      Linux
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="win-tab-download"
            id="win-download"
            tabindex="-1">
      Windows
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="deb-tab-download"
            id="deb-download"
            tabindex="-1">
      DEB
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="rpm-tab-download"
            id="rpm-download"
            tabindex="-1">
      RPM
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="mac-tab-download"
       aria-labelledby="mac-download">
<p>Version 8.10.0 of Elastic Agent has not yet been released.</p>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="linux-tab-download"
       aria-labelledby="linux-download"
       hidden="">
<p>Version 8.10.0 of Elastic Agent has not yet been released.</p>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="win-tab-download"
       aria-labelledby="win-download"
       hidden="">
<p>Version 8.10.0 of Elastic Agent has not yet been released.</p>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="deb-tab-download"
       aria-labelledby="deb-download"
       hidden="">
<p>Version 8.10.0 of Elastic Agent has not yet been released.</p>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="rpm-tab-download"
       aria-labelledby="rpm-download"
       hidden="">
<p>Version 8.10.0 of Elastic Agent has not yet been released.</p>
  </div>
</div>
<h4><a id="logs-stream-agent-config"></a>Step 2: Configure the Elastic Agent<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/logs-stream.asciidoc">edit</a></h4>
<p>You can use the Custom Logs integration in Kibana to create and download an Elastic Agent policy.
Your agent policy sets the path to your log file and sets up your data streams.</p>
<p>Complete the following steps to create and download your Elastic Agent policy:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Go to the Kibana home page and click <span class="strong strong"><strong>Add integrations</strong></span>:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/add-integrations.png" alt="Kibana home page">
</div>
</div>
</li>
<li class="listitem">
In the search bar, search for <span class="strong strong"><strong>custom</strong></span> and select <span class="strong strong"><strong>Custom Logs</strong></span>.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Add Custom Logs</strong></span> in the upper-right corner:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/add-custom-logs.png" alt="add custom logs button location">
</div>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Install Elastic Agent</strong></span>.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>standalone mode</strong></span>:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/standalone-link.png" alt="link to running agents in standalone mode">
</div>
</div>
</li>
<li class="listitem">
Add the path to your log file in the <span class="strong strong"><strong>Log file path</strong></span> field.
</li>
<li class="listitem">
Set the name for your dataset data stream in the <span class="strong strong"><strong>Dataset name</strong></span> field. The dataset name describes the data ingested and its structure. This field can contain anything that signifies the source of the data. The default value is <code class="literal">generic</code>.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Advanced options</strong></span> to open the <span class="strong strong"><strong>Integration settings</strong></span>.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/custom-log-advanced-options.png" alt="open integration settings">
</div>
</div>
</li>
<li class="listitem">
Set the name for your namespace data stream in the <span class="strong strong"><strong>Namespace</strong></span> field. The namespace is useful for grouping data such as an environment (dev, prod, or qa), a team, or a strategic business unit. Using a namespace makes it easier to search for data from a given source by using a matching pattern. The default value is <code class="literal">default</code>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save and continue</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Copy to clipboard</strong></span>, and paste the configuration in the <code class="literal">elastic-agent.yml</code> file located on your host where you extracted the Elastic Agent installation package.
</li>
<li class="listitem">
We recommend using an API key to grant the agent access to Elasticsearch. To create an API key for your agent, see <a href="/guide/en/fleet/master/grant-access-to-elasticsearch.html#create-api-key-standalone-agent" class="ulink" target="_top">Create API keys for standalone agents</a>.
</li>
<li class="listitem">
<p>Replace <code class="literal">username: '${ES_USERNAME}'</code> and <code class="literal">password: '${ES_PASSWORD}'</code> with <code class="literal">api_key:</code> in the <code class="literal">elastic-agent.yml</code> file, and add the API key you created in the previous step. For example:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">[...]
outputs:
  default:
    type: elasticsearch
    hosts:
      - 'https://da4e3a6298c14a6683e6064ebfve9ace.us-central1.gcp.cloud.es.io:443'
    api_key: _Nj4oH0aWZVGqM7MGop8:349p_U1ERHyIc4Nm8_AYkw
[...]</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The format of the key is &lt;id&gt;:&lt;key&gt;. Make sure you selected <span class="strong strong"><strong>Beats</strong></span> when you created your API key. Base64 encoded API keys are not currently supported in this configuration.</p>
</div>
</div>
</li>
</ol>
</div>
<h4><a id="logs-stream-install-agent"></a>Step 3: Install and start the Elastic Agent<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/logs-stream.asciidoc">edit</a></h4>
<p>With your configuration set, you&#8217;re ready to install the Elastic Agent. From the agent directory, run the the command that corresponds with your system to install the Elastic Agent as a service. Do <span class="strong strong"><strong>not</strong></span> enroll the agent in Fleet.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>On macOS, Linux (tar package), and Windows, run the <code class="literal">install</code> command to
install Elastic Agent as a managed service and start the service. The DEB and RPM
packages include a service unit for Linux systems with
systemd, so just enable then start the service.</p>
</div>
</div>
<div class="tabs" data-tab-group="os">
  <div role="tablist" aria-label="Run the agent standalone">
    <button role="tab"
            aria-selected="true"
            aria-controls="mac-tab-run-standalone"
            id="mac-run-standalone">
      macOS
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="linux-tab-run-standalone"
            id="linux-run-standalone"
            tabindex="-1">
      Linux
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="win-tab-run-standalone"
            id="win-run-standalone"
            tabindex="-1">
      Windows
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="deb-tab-run-standalone"
            id="deb-run-standalone"
            tabindex="-1">
      DEB
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="rpm-tab-run-standalone"
            id="rpm-run-standalone"
            tabindex="-1">
      RPM
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="mac-tab-run-standalone"
       aria-labelledby="mac-run-standalone">
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You must run this command as the root user because some
integrations require root privileges to collect sensitive data.</p>
</div>
</div>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">sudo ./elastic-agent install</pre>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="linux-tab-run-standalone"
       aria-labelledby="linux-run-standalone"
       hidden="">
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You must run this command as the root user because some
integrations require root privileges to collect sensitive data.</p>
</div>
</div>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">sudo ./elastic-agent install</pre>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="win-tab-run-standalone"
       aria-labelledby="win-run-standalone"
       hidden="">
<p>Open a PowerShell prompt as an Administrator (right-click the PowerShell icon
and select <span class="strong strong"><strong>Run As Administrator</strong></span>).</p>
<p>From the PowerShell prompt, change to the directory where you installed Elastic Agent,
and run:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">.\elastic-agent.exe install</pre>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="deb-tab-run-standalone"
       aria-labelledby="deb-run-standalone"
       hidden="">
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You must run this command as the root user because some
integrations require root privileges to collect sensitive data.</p>
</div>
</div>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">sudo systemctl enable elastic-agent <a id="CO7-1"></a><i class="conum" data-value="1"></i>
sudo systemctl start elastic-agent</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO7-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The DEB package includes a service unit for Linux systems with systemd. On
these systems, you can manage Elastic Agent by using the usual systemd commands. If
you don&#8217;t have systemd, run <code class="literal">sudo service elastic-agent start</code>.</p>
</td>
</tr>
</table>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="rpm-tab-run-standalone"
       aria-labelledby="rpm-run-standalone"
       hidden="">
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You must run this command as the root user because some
integrations require root privileges to collect sensitive data.</p>
</div>
</div>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">sudo systemctl enable elastic-agent <a id="CO8-1"></a><i class="conum" data-value="1"></i>
sudo systemctl start elastic-agent</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO8-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The RPM package includes a service unit for Linux systems with systemd. On
these systems, you can manage Elastic Agent by using the usual systemd commands. If
you don&#8217;t have systemd, run <code class="literal">sudo service elastic-agent start</code>.</p>
</td>
</tr>
</table>
</div>
  </div>
</div>
<h3><a id="logs-stream-query-datastreams"></a>View and search your data<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/logs-stream.asciidoc">edit</a></h3>
<p>With your Elastic Agent and data streams configured, you can now view, filter, and search your log data. In Kibana, navigate to <span class="strong strong"><strong>Observability → Logs → Stream</strong></span>, and use the search bar to search for your <code class="literal">data_stream.type</code>, <code class="literal">data_stream.dataset</code>, and <code class="literal">data_stream.namespace</code>.</p>
<p>See the following examples for ways to search specific data types, datasets, or namespaces:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">data_stream.type: logs</code> shows <code class="literal">logs</code> data streams.
</li>
<li class="listitem">
<code class="literal">data_stream.dataset: nginx.access</code> shows data streams with an <code class="literal">nginx.access</code> dataset.
</li>
<li class="listitem">
<code class="literal">data_stream.namespace: web-frontend</code> shows data streams with <code class="literal">web-frontend</code> namespace.
</li>
</ul>
</div>
<p>The following example shows the search results for logs with an <code class="literal">apm.error</code> dataset and a <code class="literal">default</code> namespace:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/stream-logs-example.png" alt="example search query on the logs stream page in Kibana">
</div>
</div>
<h3><a id="logs-stream-whats-next"></a>What&#8217;s next?<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/logs-stream.asciidoc">edit</a></h3>
<p>For more information on deploying and managing logs in Elastic Observability, see the following links:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <a class="xref" href="logs-checklist.html" title="Logs resource guide">Resource guide</a> consolidates links to documentation on sending log data, configuring logs, and analyzing logs.
</li>
<li class="listitem">
<a class="xref" href="monitor-logs.html" title="Log monitoring">Log monitoring</a> has information on visualizing and analyzing logs.
</li>
</ul>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="logs-checklist.html">« Logs resource guide</a>
</span>
<span class="next">
<a href="monitor-logs.html">Log monitoring »</a>
</span>
</div>
</div>
</body>
</html>
