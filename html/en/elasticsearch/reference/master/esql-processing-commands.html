<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>ES|QL processing commands | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="ES|QL processing commands | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="esql-commands.html" title="ES|QL commands"/>
<link rel="prev" href="esql-source-commands.html" title="ES|QL source commands"/>
<link rel="next" href="esql-functions-operators.html" title="ES|QL functions and operators"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="esql.html">ES|QL</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="esql-commands.html">ES|QL commands</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="esql-source-commands.html">« ES|QL source commands</a>
</span>
<span class="next">
<a href="esql-functions-operators.html">ES|QL functions and operators »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="esql-processing-commands"></a>ES|QL processing commands<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/esql/processing-commands/esql-processing-commands.asciidoc">edit</a></h2>
</div></div></div>

<p>ES|QL processing commands change an input table by adding, removing, or changing
rows and columns.</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/esql/processing-command.svg" alt="A processing command changing an input table">
</div>
</div>
<p>ES|QL supports these processing commands:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="esql-processing-commands.html#esql-dissect" title="DISSECT"><code class="literal">DISSECT</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-processing-commands.html#esql-drop" title="DROP"><code class="literal">DROP</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-processing-commands.html#esql-enrich" title="ENRICH"><code class="literal">ENRICH</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-processing-commands.html#esql-eval" title="EVAL"><code class="literal">EVAL</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-processing-commands.html#esql-grok" title="GROK"><code class="literal">GROK</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-processing-commands.html#esql-keep" title="KEEP"><code class="literal">KEEP</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-processing-commands.html#esql-limit" title="LIMIT"><code class="literal">LIMIT</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-processing-commands.html#esql-mv_expand" title="MV_EXPAND"><code class="literal">MV_EXPAND</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-processing-commands.html#esql-rename" title="RENAME"><code class="literal">RENAME</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-processing-commands.html#esql-sort" title="SORT"><code class="literal">SORT</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-processing-commands.html#esql-stats-by" title="STATS ... BY"><code class="literal">STATS ... BY</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-processing-commands.html#esql-where" title="WHERE"><code class="literal">WHERE</code></a>
</li>
</ul>
</div>
<h3><a id="esql-dissect"></a><code class="literal">DISSECT</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/esql/processing-commands/dissect.asciidoc">edit</a></h3>
<p><code class="literal">DISSECT</code> enables you to extract structured data out of a string. <code class="literal">DISSECT</code>
matches the string against a delimiter-based pattern, and extracts the specified
keys as columns.</p>
<p>Refer to the <a class="xref" href="dissect-processor.html" title="Dissect processor">dissect processor documentation</a> for the
syntax of dissect patterns.</p>
<div class="pre_wrapper lang-esql merge styled">
<pre class="programlisting prettyprint lang-esql merge styled">ROW a = "1953-01-23T12:15:00Z - some text - 127.0.0.1;"
| DISSECT a "%{Y}-%{M}-%{D}T%{h}:%{m}:%{s}Z - %{msg} - %{ip};"
| KEEP Y, M, D, h, m, s, msg, ip</pre>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" class="monospaced styled">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
<col class="col_6"/>
<col class="col_7"/>
<col class="col_8"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Y:keyword</th>
<th align="left" valign="top">M:keyword</th>
<th align="left" valign="top">D:keyword</th>
<th align="left" valign="top">h:keyword</th>
<th align="left" valign="top">m:keyword</th>
<th align="left" valign="top">s:keyword</th>
<th align="left" valign="top">msg:keyword</th>
<th align="left" valign="top">ip:keyword</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>1953</p></td>
<td align="left" valign="top"><p>01</p></td>
<td align="left" valign="top"><p>23</p></td>
<td align="left" valign="top"><p>12</p></td>
<td align="left" valign="top"><p>15</p></td>
<td align="left" valign="top"><p>00</p></td>
<td align="left" valign="top"><p>some text</p></td>
<td align="left" valign="top"><p>127.0.0.1</p></td>
</tr>
</tbody>
</table>
</div>
<h3><a id="esql-drop"></a><code class="literal">DROP</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/esql/processing-commands/drop.asciidoc">edit</a></h3>
<p>Use <code class="literal">DROP</code> to remove columns:</p>
<div class="pre_wrapper lang-esql">
<pre class="programlisting prettyprint lang-esql">FROM employees
| DROP height</pre>
</div>
<p>Rather than specify each column by name, you can use wildcards to drop all
columns with a name that matches a pattern:</p>
<div class="pre_wrapper lang-esql">
<pre class="programlisting prettyprint lang-esql">FROM employees
| DROP height*</pre>
</div>
<h3><a id="esql-enrich"></a><code class="literal">ENRICH</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/esql/processing-commands/enrich.asciidoc">edit</a></h3>
<p>You can use <code class="literal">ENRICH</code> to add data from your existing indices to incoming records.
It&#8217;s similar to <a class="xref" href="ingest-enriching-data.html" title="Enrich your data">ingest enrich</a>, but it works at query time.</p>
<div class="pre_wrapper lang-esql merge styled">
<pre class="programlisting prettyprint lang-esql merge styled">ROW language_code = "1"
| ENRICH languages_policy</pre>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" class="monospaced styled">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">language_code:keyword</th>
<th align="left" valign="top">language_name:keyword</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>1</p></td>
<td align="left" valign="top"><p>English</p></td>
</tr>
</tbody>
</table>
</div>
<p><code class="literal">ENRICH</code> requires an <a class="xref" href="ingest-enriching-data.html#enrich-policy">enrich policy</a> to be executed.
The enrich policy defines a match field (a key field) and a set of enrich fields.</p>
<p><code class="literal">ENRICH</code> will look for records in the <a class="xref" href="ingest-enriching-data.html#enrich-index">enrich index</a> based on the match field value.
The matching key in the input dataset can be defined using <code class="literal">ON &lt;field-name&gt;</code>; if it&#8217;s not specified,
the match will be performed on a field with the same name as the match field defined in the <a class="xref" href="ingest-enriching-data.html#enrich-policy">enrich policy</a>.</p>
<div class="pre_wrapper lang-esql merge styled">
<pre class="programlisting prettyprint lang-esql merge styled">ROW a = "1"
| ENRICH languages_policy ON a</pre>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" class="monospaced styled">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">a:keyword</th>
<th align="left" valign="top">language_name:keyword</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>1</p></td>
<td align="left" valign="top"><p>English</p></td>
</tr>
</tbody>
</table>
</div>
<p>You can specify which attributes (between those defined as enrich fields in the policy) have to be added to the result,
using <code class="literal">WITH &lt;field1&gt;, &lt;field2&gt;...</code> syntax.</p>
<div class="pre_wrapper lang-esql merge styled">
<pre class="programlisting prettyprint lang-esql merge styled">ROW a = "1"
| ENRICH languages_policy ON a WITH language_name</pre>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" class="monospaced styled">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">a:keyword</th>
<th align="left" valign="top">language_name:keyword</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>1</p></td>
<td align="left" valign="top"><p>English</p></td>
</tr>
</tbody>
</table>
</div>
<p>Attributes can also be renamed using <code class="literal">WITH new_name=&lt;field1&gt;</code></p>
<div class="pre_wrapper lang-esql merge styled">
<pre class="programlisting prettyprint lang-esql merge styled">ROW a = "1"
| ENRICH languages_policy ON a WITH name = language_name</pre>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" class="monospaced styled">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">a:keyword</th>
<th align="left" valign="top">name:keyword</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>1</p></td>
<td align="left" valign="top"><p>English</p></td>
</tr>
</tbody>
</table>
</div>
<p>By default (if no <code class="literal">WITH</code> is defined), <code class="literal">ENRICH</code> will add all the enrich fields defined in the <a class="xref" href="ingest-enriching-data.html#enrich-policy">enrich policy</a>
to the result.</p>
<p>In case of name collisions, the newly created fields will override the existing fields.</p>
<h3><a id="esql-eval"></a><code class="literal">EVAL</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/esql/processing-commands/eval.asciidoc">edit</a></h3>
<p><code class="literal">EVAL</code> enables you to append new columns:</p>
<div class="pre_wrapper lang-esql merge styled">
<pre class="programlisting prettyprint lang-esql merge styled">FROM employees
| SORT emp_no
| KEEP first_name, last_name, height
| EVAL height_feet = height * 3.281, height_cm = height * 100</pre>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" class="monospaced styled">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">first_name:keyword</th>
<th align="left" valign="top">last_name:keyword</th>
<th align="left" valign="top">height:double</th>
<th align="left" valign="top">height_feet:double</th>
<th align="left" valign="top">height_cm:double</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>Georgi</p></td>
<td align="left" valign="top"><p>Facello</p></td>
<td align="left" valign="top"><p>2.03</p></td>
<td align="left" valign="top"><p>6.66043</p></td>
<td align="left" valign="top"><p>202.99999999999997</p></td>
</tr>
</tbody>
</table>
</div>
<p>If the specified column already exists, the existing column will be dropped, and
the new column will be appended to the table:</p>
<div class="pre_wrapper lang-esql merge styled">
<pre class="programlisting prettyprint lang-esql merge styled">FROM employees
| SORT emp_no
| KEEP first_name, last_name, height
| EVAL height = height * 3.281</pre>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" class="monospaced styled">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">first_name:keyword</th>
<th align="left" valign="top">last_name:keyword</th>
<th align="left" valign="top">height:double</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>Georgi</p></td>
<td align="left" valign="top"><p>Facello</p></td>
<td align="left" valign="top"><p>6.66043</p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="_functions"></a>Functions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/esql/processing-commands/eval.asciidoc">edit</a></h4>
<p><code class="literal">EVAL</code> supports various functions for calculating values. Refer to
<a class="xref" href="esql-functions-operators.html#esql-functions">Functions</a> for more information.</p>
<h3><a id="esql-grok"></a><code class="literal">GROK</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/esql/processing-commands/grok.asciidoc">edit</a></h3>
<p><code class="literal">GROK</code> enables you to extract structured data out of a string. <code class="literal">GROK</code> matches
the string against patterns, based on regular expressions, and extracts the
specified patterns as columns.</p>
<p>Refer to the <a class="xref" href="grok-processor.html" title="Grok processor">grok processor documentation</a> for the syntax for
of grok patterns.</p>
<p>For example:</p>
<div class="pre_wrapper lang-esql merge styled">
<pre class="programlisting prettyprint lang-esql merge styled">ROW a = "1953-01-23T12:15:00Z 127.0.0.1 some.email@foo.com 42"
| GROK a "%{TIMESTAMP_ISO8601:date} %{IP:ip} %{EMAILADDRESS:email} %{NUMBER:num:int}"
| KEEP date, ip, email, num</pre>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" class="monospaced styled">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">date:keyword</th>
<th align="left" valign="top">ip:keyword</th>
<th align="left" valign="top">email:keyword</th>
<th align="left" valign="top">num:integer</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>1953-01-23T12:15:00Z</p></td>
<td align="left" valign="top"><p>127.0.0.1</p></td>
<td align="left" valign="top"><p><a href="mailto:some.email@foo.com" class="ulink" target="_top">some.email@foo.com</a></p></td>
<td align="left" valign="top"><p>42</p></td>
</tr>
</tbody>
</table>
</div>
<h3><a id="esql-keep"></a><code class="literal">KEEP</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/esql/processing-commands/keep.asciidoc">edit</a></h3>
<p>The <code class="literal">KEEP</code> command enables you to specify what columns are returned and the
order in which they are returned.</p>
<p>To limit the columns that are returned, use a comma-separated list of column
names. The columns are returned in the specified order:</p>
<div class="pre_wrapper lang-esql merge styled">
<pre class="programlisting prettyprint lang-esql merge styled">FROM employees
| KEEP emp_no, first_name, last_name, height</pre>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" class="monospaced styled">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">emp_no:integer</th>
<th align="left" valign="top">first_name:keyword</th>
<th align="left" valign="top">last_name:keyword</th>
<th align="left" valign="top">height:double</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>10001</p></td>
<td align="left" valign="top"><p>Georgi</p></td>
<td align="left" valign="top"><p>Facello</p></td>
<td align="left" valign="top"><p>2.03</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>10002</p></td>
<td align="left" valign="top"><p>Bezalel</p></td>
<td align="left" valign="top"><p>Simmel</p></td>
<td align="left" valign="top"><p>2.08</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>10003</p></td>
<td align="left" valign="top"><p>Parto</p></td>
<td align="left" valign="top"><p>Bamford</p></td>
<td align="left" valign="top"><p>1.83</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>10004</p></td>
<td align="left" valign="top"><p>Chirstian</p></td>
<td align="left" valign="top"><p>Koblick</p></td>
<td align="left" valign="top"><p>1.78</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>10005</p></td>
<td align="left" valign="top"><p>Kyoichi</p></td>
<td align="left" valign="top"><p>Maliniak</p></td>
<td align="left" valign="top"><p>2.05</p></td>
</tr>
</tbody>
</table>
</div>
<p>Rather than specify each column by name, you can use wildcards to return all
columns with a name that matches a pattern:</p>
<div class="pre_wrapper lang-esql">
<pre class="programlisting prettyprint lang-esql">FROM employees
| KEEP h*</pre>
</div>
<p>The asterisk wildcard (<code class="literal">*</code>) by itself translates to all columns that do not
match the other arguments. This query will first return all columns with a name
that starts with an h, followed by all other columns:</p>
<div class="pre_wrapper lang-esql">
<pre class="programlisting prettyprint lang-esql">FROM employees
| KEEP h*, *</pre>
</div>
<h3><a id="esql-limit"></a><code class="literal">LIMIT</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/esql/processing-commands/limit.asciidoc">edit</a></h3>
<p>The <code class="literal">LIMIT</code> processing command enables you to limit the number of rows:</p>
<div class="pre_wrapper lang-esql">
<pre class="programlisting prettyprint lang-esql">FROM employees
| SORT emp_no ASC
| LIMIT 5</pre>
</div>
<p>If not specified, <code class="literal">LIMIT</code> defaults to <code class="literal">500</code>. A single query will not return
more than 10,000 rows, regardless of the <code class="literal">LIMIT</code> value.</p>
<h3><a id="esql-mv_expand"></a><code class="literal">MV_EXPAND</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/esql/processing-commands/mv_expand.asciidoc">edit</a></h3>
<p>The <code class="literal">MV_EXPAND</code> processing command expands multivalued fields into one row per value, duplicating other fields:</p>
<div class="pre_wrapper lang-esql merge styled">
<pre class="programlisting prettyprint lang-esql merge styled">ROW a=[1,2,3], b="b", j=["a","b"]
| MV_EXPAND a</pre>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" class="monospaced styled">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">a:integer</th>
<th align="left" valign="top">b:keyword</th>
<th align="left" valign="top">j:keyword</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>1</p></td>
<td align="left" valign="top"><p>b</p></td>
<td align="left" valign="top"><p>["a", "b"]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>2</p></td>
<td align="left" valign="top"><p>b</p></td>
<td align="left" valign="top"><p>["a", "b"]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>3</p></td>
<td align="left" valign="top"><p>b</p></td>
<td align="left" valign="top"><p>["a", "b"]</p></td>
</tr>
</tbody>
</table>
</div>
<h3><a id="esql-rename"></a><code class="literal">RENAME</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/esql/processing-commands/rename.asciidoc">edit</a></h3>
<p>Use <code class="literal">RENAME</code> to rename a column using the following syntax:</p>
<div class="pre_wrapper lang-esql">
<pre class="programlisting prettyprint lang-esql">RENAME &lt;old-name&gt; AS &lt;new-name&gt;</pre>
</div>
<p>For example:</p>
<div class="pre_wrapper lang-esql">
<pre class="programlisting prettyprint lang-esql">FROM employees
| KEEP first_name, last_name, still_hired
| RENAME  still_hired AS employed</pre>
</div>
<p>If a column with the new name already exists, it will be replaced by the new
column.</p>
<p>Multiple columns can be renamed with a single <code class="literal">RENAME</code> command:</p>
<div class="pre_wrapper lang-esql">
<pre class="programlisting prettyprint lang-esql">FROM employees
| KEEP first_name, last_name
| RENAME first_name AS fn, last_name AS ln</pre>
</div>
<h3><a id="esql-sort"></a><code class="literal">SORT</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/esql/processing-commands/sort.asciidoc">edit</a></h3>
<p>Use the <code class="literal">SORT</code> command to sort rows on one or more fields:</p>
<div class="pre_wrapper lang-esql">
<pre class="programlisting prettyprint lang-esql">FROM employees
| KEEP first_name, last_name, height
| SORT height</pre>
</div>
<p>The default sort order is ascending. Set an explicit sort order using <code class="literal">ASC</code> or
<code class="literal">DESC</code>:</p>
<div class="pre_wrapper lang-esql">
<pre class="programlisting prettyprint lang-esql">FROM employees
| KEEP first_name, last_name, height
| SORT height DESC</pre>
</div>
<p>Two rows with the same sort key are considered equal. You can provide additional
sort expressions to act as tie breakers:</p>
<div class="pre_wrapper lang-esql">
<pre class="programlisting prettyprint lang-esql">FROM employees
| KEEP first_name, last_name, height
| SORT height DESC, first_name ASC</pre>
</div>
<h4><a id="_null_values"></a><code class="literal">null</code> values<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/esql/processing-commands/sort.asciidoc">edit</a></h4>
<p>By default, <code class="literal">null</code> values are treated as being larger than any other value. With
an ascending sort order, <code class="literal">null</code> values are sorted last, and with a descending
sort order, <code class="literal">null</code> values are sorted first. You can change that by providing
<code class="literal">NULLS FIRST</code> or <code class="literal">NULLS LAST</code>:</p>
<div class="pre_wrapper lang-esql">
<pre class="programlisting prettyprint lang-esql">FROM employees
| KEEP first_name, last_name, height
| SORT first_name ASC NULLS FIRST</pre>
</div>
<h3><a id="esql-stats-by"></a><code class="literal">STATS ... BY</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/esql/processing-commands/stats.asciidoc">edit</a></h3>
<p>Use <code class="literal">STATS ... BY</code> to group rows according to a common value and calculate one
or more aggregated values over the grouped rows.</p>
<div class="pre_wrapper lang-esql merge styled">
<pre class="programlisting prettyprint lang-esql merge styled">FROM employees
| STATS count = COUNT(emp_no) BY languages
| SORT languages</pre>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" class="monospaced styled">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">count:long</th>
<th align="left" valign="top">languages:integer</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>15</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>19</p></td>
<td align="left" valign="top"><p>2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>17</p></td>
<td align="left" valign="top"><p>3</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>18</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>21</p></td>
<td align="left" valign="top"><p>5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>10</p></td>
<td align="left" valign="top"><p>null</p></td>
</tr>
</tbody>
</table>
</div>
<p>If <code class="literal">BY</code> is omitted, the output table contains exactly one row with the
aggregations applied over the entire dataset:</p>
<div class="pre_wrapper lang-esql merge styled">
<pre class="programlisting prettyprint lang-esql merge styled">FROM employees
| STATS avg_lang = AVG(languages)</pre>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" class="monospaced styled">
<colgroup>
<col class="col_1"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">avg_lang:double</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>3.1222222222222222</p></td>
</tr>
</tbody>
</table>
</div>
<p>It&#8217;s possible to calculate multiple values:</p>
<div class="pre_wrapper lang-esql">
<pre class="programlisting prettyprint lang-esql">FROM employees
| STATS avg_lang = AVG(languages), max_lang = MAX(languages)</pre>
</div>
<p>It&#8217;s also possible to group by multiple values (only supported for long and
keyword family fields):</p>
<div class="pre_wrapper lang-esql">
<pre class="programlisting prettyprint lang-esql">FROM employees
| EVAL hired = DATE_FORMAT("YYYY", hire_date)
| STATS avg_salary = AVG(salary) BY hired, languages.long
| EVAL avg_salary = ROUND(avg_salary)
| SORT hired, languages.long</pre>
</div>
<p>The following aggregation functions are supported:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="esql-agg-functions.html#esql-agg-avg" title="AVG"><code class="literal">AVG</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-agg-functions.html#esql-agg-count" title="COUNT"><code class="literal">COUNT</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-agg-functions.html#esql-agg-count-distinct" title="COUNT_DISTINCT"><code class="literal">COUNT_DISTINCT</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-agg-functions.html#esql-agg-max" title="MAX"><code class="literal">MAX</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-agg-functions.html#esql-agg-median" title="MEDIAN"><code class="literal">MEDIAN</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-agg-functions.html#esql-agg-median-absolute-deviation" title="MEDIAN_ABSOLUTE_DEVIATION"><code class="literal">MEDIAN_ABSOLUTE_DEVIATION</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-agg-functions.html#esql-agg-min" title="MIN"><code class="literal">MIN</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-agg-functions.html#esql-agg-percentile" title="PERCENTILE"><code class="literal">PERCENTILE</code></a>
</li>
<li class="listitem">
<a class="xref" href="esql-agg-functions.html#esql-agg-sum" title="SUM"><code class="literal">SUM</code></a>
</li>
</ul>
</div>
<h3><a id="esql-where"></a><code class="literal">WHERE</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/esql/processing-commands/where.asciidoc">edit</a></h3>
<p>Use <code class="literal">WHERE</code> to produce a table that contains all the rows from the input table
for which the provided condition evaluates to <code class="literal">true</code>:</p>
<div class="pre_wrapper lang-esql">
<pre class="programlisting prettyprint lang-esql">FROM employees
| KEEP first_name, last_name, still_hired
| WHERE still_hired == true</pre>
</div>
<p>Which, if <code class="literal">still_hired</code> is a boolean field, can be simplified to:</p>
<div class="pre_wrapper lang-esql">
<pre class="programlisting prettyprint lang-esql">FROM employees
| KEEP first_name, last_name, still_hired
| WHERE still_hired</pre>
</div>
<h4><a id="_operators"></a>Operators<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/esql/processing-commands/where.asciidoc">edit</a></h4>
<p>Refer to <a class="xref" href="esql-operators.html" title="ES|QL operators">Operators</a> for an overview of the supported operators.</p>
<h4><a id="_functions_2"></a>Functions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/esql/processing-commands/where.asciidoc">edit</a></h4>
<p><code class="literal">WHERE</code> supports various functions for calculating values. Refer to
<a class="xref" href="esql-functions-operators.html#esql-functions">Functions</a> for more information.</p>
<div class="pre_wrapper lang-esql">
<pre class="programlisting prettyprint lang-esql">FROM employees
| KEEP first_name, last_name, height
| WHERE length(first_name) &lt; 4</pre>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="esql-source-commands.html">« ES|QL source commands</a>
</span>
<span class="next">
<a href="esql-functions-operators.html">ES|QL functions and operators »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {"alternatives":{"console":{"php":{"hasAny":true},"python":{"hasAny":true},"ruby":{"hasAny":true},"go":{"hasAny":true},"js":{"hasAny":true}}}}</script>
  </body>
</html>
